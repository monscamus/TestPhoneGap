<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Inspector</title>
        <link rel="stylesheet" href="./jquery.mobile-1.1.0.min.css" />
        <link rel="stylesheet" href="./my.css" />
        <style>
            /* App custom styles */
        </style>
        <script src="jquery.min.js"></script>
        <script src="jquery.mobile-1.1.0.min.js"></script>
         <!-- include phonegap / callback -->
			<script type="text/javascript" charset="utf-8" src="phonegap-1.2.0.js"></script>
		    <!-- required for oauth plugin support -->    
		    <script type="text/javascript" src="SalesforceOAuthPlugin.js"></script>
		
		    <!-- include forcetk for REST transaction support -->
		    <script src="forcetk.js"></script>
		    
		    <!-- include local utility functionality -->
		    <link rel="stylesheet" type="text/css" href="SFHybridApp.css" />
		    <script type="text/javascript" charset="utf-8" src="SFHybridApp.js"></script>
		
		    <script type="text/javascript" charset="utf-8">
		
		    
		    // The version of the REST API you wish to use in your app.
		    var apiVersion = "v23.0";
		
			// If you want to prevent dragging, uncomment this section
			/*
			function preventBehavior(e) 
			{ 
		      e.preventDefault(); 
		    };
			document.addEventListener("touchmove", preventBehavior, false);
			*/
			
			/* If you are supporting your own protocol, the var invokeString will contain any arguments to the app launch.
			see http://iphonedevelopertips.com/cocoa/launching-your-own-application-via-a-custom-url-scheme.html
			for more details -jm */
			/*
			function handleOpenURL(url)
			{
				// do something with the url passed in.
			}
			*/
			
		    var forcetkClient;
		    var debugMode = true;
		
		    jQuery(document).ready(function() {
		        //Add event listeners and so forth here
		        SFHybridApp.logToConsole("onLoad: jquery ready");
				document.addEventListener("deviceready", onDeviceReady,false);
		
		    });
		
		    // When this function is called, PhoneGap has been initialized and is ready to roll 
		    function onDeviceReady() {
		        SFHybridApp.logToConsole("onDeviceReady: PhoneGap ready");
				//Call getAuthCredentials to get the initial session credentials
		        SalesforceOAuthPlugin.getAuthCredentials(salesforceSessionRefreshed, getAuthCredentialsError);
		
		        //register to receive notifications when autoRefreshOnForeground refreshes the sfdc session
		        document.addEventListener("salesforceSessionRefresh",salesforceSessionRefreshed,false);
		
		        //enable buttons
		        regLinkClickHandlers();
		    }
		        
		
		    function salesforceSessionRefreshed(creds) {
		        SFHybridApp.logToConsole("salesforceSessionRefreshed");
				
		        forcetkClient = new forcetk.Client(creds.clientId, creds.loginUrl);
		        forcetkClient.setSessionToken(creds.accessToken, apiVersion, creds.instanceUrl);
		        forcetkClient.setRefreshToken(creds.refreshToken);
		        forcetkClient.setUserAgentString(creds.userAgent);
		    }
		
		
		    function getAuthCredentialsError(error) {
		        SFHybridApp.logToConsole("getAuthCredentialsError: " + error);
		    }
		        
		    </script>
		        
			<!-- load our app-specific code -->
		    <script src="inline.js"></script>       
        
    </head>
    <body>
        <div data-role="page" id="page1">
            <div data-theme="a" data-role="header">
                <h2>
                    Inspector
                </h2>
            </div>
            <div data-role="content">
                <div data-role="collapsible-set" data-theme="b" data-content-theme="b">
                    <div data-role="collapsible" data-collapsed="false">
                        <h3>
                            Inspections
                        </h3>
                        <div id="div_inspection_list"></div>
                    </div>
                    <div data-role="collapsible" data-collapsed="false">
                        <h3>
                            Details
                        </h3>
                        <input type="submit" value="Submit" />
                        <div data-role="fieldcontain">
                            <fieldset data-role="controlgroup">
                                <label for="textinput1">
                                    Visit Started
                                </label>
                                <input id="textinput1" placeholder="" value="" type="text" />
                            </fieldset>
                        </div>
                        <div data-role="fieldcontain">
                            <fieldset data-role="controlgroup">
                                <label for="textinput2">
                                    Visit Ended
                                </label>
                                <input id="textinput2" placeholder="" value="" type="text" />
                            </fieldset>
                        </div>
                        <div data-role="fieldcontain">
                            <label for="selectmenu1">
                                Outcome:
                            </label>
                            <select name="selectmenu1" id="selectmenu1">
                                <option value="Complete">
                                    Complete
                                </option>
                            </select>
                        </div>
                    </div>
                    <div data-role="collapsible" data-collapsed="true">
                        <h3>
                            Map
                        </h3>
                        <img src="https://maps.googleapis.com/maps/api/staticmap?center=Madison, WI&amp;zoom=14&amp;size=288x200&amp;markers=Madison, WI&amp;sensor=false" width="288" height="200" />
                    </div>
                </div>
            </div>
        </div>
        <script>
            //App custom javascript
        </script>
    </body>
</html>